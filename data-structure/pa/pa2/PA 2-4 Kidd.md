# PA 2-4 Kidd

## 数据结构与算法

本题中使用的数据结构为带懒惰标记的线段树，实现方式与讲义上的内容基本一致。算法方面，采用了动态开点，查询或翻转操作需要某个区间时再给某个区间分配内存。并且加入了懒惰标记，翻转时若在某个区间完全命中（即该区间范围与访问到该区间时的搜索范围完全一致），那么不再往下翻转，该区间的懒惰标记自增，表示该区间的左右孩子少进行了懒惰标记次的更新。每次向下访问时需要将父亲懒惰标记继承给两个孩子，两个孩子的翻转次数根据懒惰标记额外增加，并将父亲的懒惰标记置零。

## 复杂度分析

空间复杂度方面，采用了动态开点的算法​，所以在操作数较少时区间点不会开全，那么每次操作开点数为$O(logn)$，总的开点数为$O(mlogn)$。当然节点个数最多$O(nlogn)$，所以总体空间复杂度为$O(max\{m,n\}logn)$，本题中$m$比$n$小很多，所以可以认为是$O(mlogn)$。

时间复杂度方面，每一次操作最多访问$O(logn)$个区间，总体时间复杂度为为$O(mlogn)$。

## 完成过程中的问题

`

## 完成过程中的问题

我从一开始就确定了线段树+懒惰标记的算法，完成过程中遇到的主要问题是`int`越界。参考题目提示以后，我把与答案有关的量都设成了`long long`，但是在计算过程中每次取区间中值的过程量`middle = (t_left + t_right) / 2`会发生越界，而且它在五成测时都没有越界，九成测时全部越界，最后我生成随机数排除了这个问题。